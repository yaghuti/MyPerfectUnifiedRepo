name: AWS CloudTrail ConsoleLogin
id: b68b3f26-bd21-4fa8-b593-616fe75ac0ae
version: 2
date: '2025-01-23'
author: Patrick Bareiss, Splunk
description: Logs attempts to sign in to the AWS Management Console, including successful
  and failed login events.
mitre_components:
- User Account Authentication
- Logon Session Creation
- User Account Metadata
- Logon Session Metadata
- Cloud Service Metadata
source: aws_cloudtrail
sourcetype: aws:cloudtrail
separator: eventName
separator_value: ConsoleLogin
supported_TA:
- name: Splunk Add-on for AWS
  url: https://splunkbase.splunk.com/app/1876
  version: 7.11.0
fields:
- _time
- action
- additionalEventData.LoginTo
- additionalEventData.MFAUsed
- additionalEventData.MobileVersion
- app
- authentication_method
- awsRegion
- aws_account_id
- command
- date_hour
- date_mday
- date_minute
- date_month
- date_second
- date_wday
- date_year
- date_zone
- desc
- dest
- dvc
- errorCode
- errorMessage
- eventCategory
- eventID
- eventName
- eventSource
- eventTime
- eventType
- eventVersion
- eventtype
- host
- index
- linecount
- managementEvent
- msg
- object_category
- product
- punct
- readOnly
- reason
- recipientAccountId
- region
- requestParameters
- responseElements.ConsoleLogin
- result
- signature
- source
- sourceIPAddress
- sourcetype
- splunk_server
- src
- src_ip
- start_time
- status
- tag
- tag::action
- tag::eventtype
- timeendpos
- timestartpos
- tlsDetails.cipherSuite
- tlsDetails.clientProvidedHostHeader
- tlsDetails.tlsVersion
- userAgent
- userIdentity.accessKeyId
- userIdentity.accountId
- userIdentity.type
- userIdentity.userName
- user_access_key
- user_agent
- user_group_id
- user_name
- user_type
- vendor
- vendor_account
- vendor_product
- vendor_region
example_log: '{"eventVersion": "1.08", "userIdentity": {"type": "IAMUser", "accountId":
  "111111111111", "accessKeyId": "", "userName": "HIDDEN_DUE_TO_SECURITY_REASONS"},
  "eventTime": "2022-10-19T20:33:38Z", "eventSource": "signin.amazonaws.com", "eventName":
  "ConsoleLogin", "awsRegion": "us-east-1", "sourceIPAddress": "142.254.89.27", "userAgent":
  "Go-http-client/1.1", "errorMessage": "No username found in supplied account", "requestParameters":
  null, "responseElements": {"ConsoleLogin": "Failure"}, "additionalEventData": {"LoginTo":
  "https://console.aws.amazon.com", "MobileVersion": "No", "MFAUsed": "No"}, "eventID":
  "9fcfb8c3-3fca-48db-85d2-7b107f9d95d0", "readOnly": false, "eventType": "AwsConsoleSignIn",
  "managementEvent": true, "recipientAccountId": "111111111111", "eventCategory":
  "Management", "tlsDetails": {"tlsVersion": "TLSv1.2", "cipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",
  "clientProvidedHostHeader": "signin.aws.amazon.com"}}'
output_fields:
- dest
- user
- user_agent
- src
- vendor_account
- vendor_region
- vendor_product
