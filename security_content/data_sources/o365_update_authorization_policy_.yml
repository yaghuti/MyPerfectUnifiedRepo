name: O365 Update authorization policy.
id: d40e6a20-4d64-404c-8351-2caae8228d34
version: 2
date: '2025-01-23'
author: Patrick Bareiss, Splunk
description: Logs changes to authorization policies in Microsoft 365, including updates
  to access controls, permissions, and security settings.
mitre_components:
- Cloud Service Modification
- Configuration Modification
- User Account Metadata
- Application Log Content
source: o365
sourcetype: o365:management:activity
separator: Operation
separator_value: Update authorization policy.
supported_TA:
- name: Splunk Add-on for Microsoft Office 365
  url: https://splunkbase.splunk.com/app/4055
  version: 4.9.0
fields:
- _time
- ActorContextId
- Actor{}.ID
- Actor{}.Type
- AzureActiveDirectoryEventType
- CreationTime
- ExtendedProperties{}.Name
- ExtendedProperties{}.Value
- Id
- InterSystemsId
- IntraSystemId
- ModifiedProperties{}.Name
- ModifiedProperties{}.NewValue
- ModifiedProperties{}.OldValue
- ObjectId
- Operation
- OrganizationId
- RecordType
- ResultStatus
- SupportTicketId
- TargetContextId
- Target{}.ID
- Target{}.Type
- UserId
- UserKey
- UserType
- Version
- Workload
- additionalDetails
- app
- authentication_service
- command
- date_hour
- date_mday
- date_minute
- date_month
- date_second
- date_wday
- date_year
- date_zone
- dest
- dest_name
- dvc
- event_type
- extendedAuditEventCategory
- host
- index
- linecount
- object
- punct
- record_type
- signature
- source
- sourcetype
- splunk_server
- status
- timeendpos
- timestartpos
- user
- user_agent
- user_agent_change
- user_id
- user_type
- vendor_account
- vendor_product
example_log: '{"CreationTime": "2023-10-26T19:22:20", "Id": "83774e72-313f-4d1f-8609-7d0c7bb3b4ff",
  "Operation": "Update authorization policy.", "OrganizationId": "a417c578-c7ee-480d-a225-d48057e74df5",
  "RecordType": 8, "ResultStatus": "Success", "UserKey": "1003BFFD98415B4E@splunkresearch.onmicrosoft.com",
  "UserType": 0, "Version": 1, "Workload": "AzureActiveDirectory", "ObjectId": "AuthorizationPolicy_24484114-1daa-4700-aaf7-44ee5cbe5678",
  "UserId": "user30@splunkresearch.onmicrosoft.com", "AzureActiveDirectoryEventType":
  1, "ExtendedProperties": [{"Name": "additionalDetails", "Value": "{\"User-Agent\":\"Swagger-Codegen/1.0.0.0/csharp/msal\"}"},
  {"Name": "extendedAuditEventCategory", "Value": "AuthorizationPolicy"}], "ModifiedProperties":
  [{"Name": "AllowUserConsentForRiskyApps", "NewValue": "[\r\n  true\r\n]", "OldValue":
  "[\r\n  false\r\n]"}, {"Name": "PermissionGrantPolicyIdsAssignedToDefaultUserRole",
  "NewValue": "[\r\n  \"microsoft-user-default-legacy\"\r\n]", "OldValue": "[\r\n  \"ManagePermissionGrantsForSelf.microsoft-user-default-legacy\"\r\n]"},
  {"Name": "Included Updated Properties", "NewValue": "AllowUserConsentForRiskyApps,
  PermissionGrantPolicyIdsAssignedToDefaultUserRole", "OldValue": ""}], "Actor": [{"ID":
  "user30@splunkresearch.onmicrosoft.com", "Type": 5}, {"ID": "1003BFFD98415B4E",
  "Type": 3}, {"ID": "User_e4c722ac-3b83-478d-8f52-c388885dc30f", "Type": 2}, {"ID":
  "e4c722ac-3b83-478d-8f52-c388885dc30f", "Type": 2}, {"ID": "User", "Type": 2}],
  "ActorContextId": "a417c578-c7ee-480d-a225-d48057e74df5", "InterSystemsId": "cc46d719-4c0f-4b78-8795-b0d6ca5b2065",
  "IntraSystemId": "92a0d051-2d0d-4608-9d09-6fca619764a2", "SupportTicketId": "",
  "Target": [{"ID": "AuthorizationPolicy_24484114-1daa-4700-aaf7-44ee5cbe5678", "Type":
  2}, {"ID": "24484114-1daa-4700-aaf7-44ee5cbe5678", "Type": 2}, {"ID": "Other", "Type":
  2}, {"ID": "Authorization Policy", "Type": 1}], "TargetContextId": "a417c578-c7ee-480d-a225-d48057e74df5"}'
output_fields:
- dest
- user
- src
- vendor_account
- vendor_product
