name: Sysmon EventID 20
id: aeee5374-3203-4286-b744-a8cc4ad1cd7e
version: 3
date: '2025-07-10'
author: Patrick Bareiss, Splunk
description: Logs WMI (Windows Management Instrumentation) consumer activity, including
  details about the WMI event consumer, associated process, and event data.
mitre_components:
- WMI Creation
- Process Metadata
- Application Log Content
- OS API Execution
source: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
sourcetype: XmlWinEventLog
separator: EventID
configuration: https://github.com/SwiftOnSecurity/sysmon-config
supported_TA:
- name: Splunk Add-on for Sysmon
  url: https://splunkbase.splunk.com/app/5709
  version: 5.0.0
fields:
- _time
- Channel
- Computer
- Destination
- DestinationNoQuotes
- EventChannel
- EventCode
- EventData_Xml
- EventDescription
- EventID
- EventRecordID
- EventType
- Guid
- Keywords
- Level
- Name
- Opcode
- Operation
- ProcessID
- RecordID
- RecordNumber
- RuleName
- SecurityID
- SystemTime
- System_Props_Xml
- Task
- ThreadID
- TimeCreated
- Type
- User
- UserID
- UtcTime
- Version
- action
- change_type
- date_hour
- date_mday
- date_minute
- date_month
- date_second
- date_wday
- date_year
- date_zone
- dest
- dvc
- dvc_nt_host
- event_id
- eventtype
- host
- id
- index
- linecount
- object
- object_category
- object_path
- punct
- severity_id
- signature
- signature_id
- source
- sourcetype
- splunk_server
- src
- status
- tag
- tag::eventtype
- timeendpos
- timestartpos
- user
- user_id
- user_name
- vendor_product
output_fields:
- dest
- dvc
- object
- object_category
- object_path
- signature
- signature_id
- src
- status
- user
- user_id
- vendor_product
example_log: <Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider
  Name='Microsoft-Windows-Sysmon' Guid='{5770385F-C22A-43E0-BF4C-06F5698FFBD9}'/><EventID>20</EventID><Version>3</Version><Level>4</Level><Task>20</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated
  SystemTime='2020-12-08T13:54:48.517698800Z'/><EventRecordID>6249</EventRecordID><Correlation/><Execution
  ProcessID='2504' ThreadID='3252'/><Channel>Microsoft-Windows-Sysmon/Operational</Channel><Computer>win-dc-935.attackrange.local</Computer><Security
  UserID='S-1-5-18'/></System><EventData><Data Name='RuleName'>-</Data><Data Name='EventType'>WmiConsumerEvent</Data><Data
  Name='UtcTime'>2020-12-08 13:54:48.514</Data><Data Name='Operation'>Deleted</Data><Data
  Name='User'>ATTACKRANGE\Administrator</Data><Data Name='Name'> "AtomicRedTeam-WMIPersistence-Example"</Data><Data
  Name='Type'>Command Line</Data><Data Name='Destination'> "C:\\Windows\\System32\\notepad.exe"</Data></EventData></Event>
