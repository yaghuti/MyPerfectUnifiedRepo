name: AWS CloudTrail UpdateAccountPasswordPolicy
id: 35a8cc97-3600-40e1-a5d1-1c2ad5060be0
version: 2
date: '2025-01-23'
author: Patrick Bareiss, Splunk
description: Logs an event when an AWS account's password policy is updated.
mitre_components:
- User Account Modification
- Cloud Service Modification
source: aws_cloudtrail
sourcetype: aws:cloudtrail
separator: eventName
separator_value: UpdateAccountPasswordPolicy
supported_TA:
- name: Splunk Add-on for AWS
  url: https://splunkbase.splunk.com/app/1876
  version: 7.11.0
fields:
- _time
- action
- app
- awsRegion
- aws_account_id
- change_type
- command
- date_hour
- date_mday
- date_minute
- date_month
- date_second
- date_wday
- date_year
- date_zone
- dest
- dvc
- errorCode
- eventCategory
- eventID
- eventName
- eventSource
- eventTime
- eventType
- eventVersion
- eventtype
- host
- index
- linecount
- managementEvent
- msg
- object_category
- product
- punct
- readOnly
- recipientAccountId
- region
- requestID
- requestParameters.allowUsersToChangePassword
- requestParameters.hardExpiry
- requestParameters.minimumPasswordLength
- requestParameters.requireLowercaseCharacters
- requestParameters.requireNumbers
- requestParameters.requireSymbols
- requestParameters.requireUppercaseCharacters
- responseElements
- sessionCredentialFromConsole
- signature
- source
- sourceIPAddress
- sourcetype
- splunk_server
- src
- src_ip
- start_time
- status
- tag
- tag::eventtype
- timeendpos
- timestartpos
- user
- userAgent
- userIdentity.accessKeyId
- userIdentity.accountId
- userIdentity.arn
- userIdentity.principalId
- userIdentity.sessionContext.attributes.creationDate
- userIdentity.sessionContext.attributes.mfaAuthenticated
- userIdentity.type
- userName
- user_access_key
- user_agent
- user_arn
- user_group_id
- user_id
- user_name
- user_type
- vendor
- vendor_account
- vendor_product
- vendor_region
example_log: '{"eventVersion": "1.08", "userIdentity": {"type": "Root", "principalId":
  "111111111111", "arn": "arn:aws:iam::111111111111:root", "accountId": "111111111111",
  "accessKeyId": "ASIASBMSCQHHZZ4THONS", "sessionContext": {"sessionIssuer": {}, "webIdFederationData":
  {}, "attributes": {"creationDate": "2023-01-26T22:10:41Z", "mfaAuthenticated": "false"}}},
  "eventTime": "2023-01-26T22:38:59Z", "eventSource": "iam.amazonaws.com", "eventName":
  "UpdateAccountPasswordPolicy", "awsRegion": "us-east-1", "sourceIPAddress": "23.93.193.7",
  "userAgent": "AWS Internal", "requestParameters": {"minimumPasswordLength": 6, "requireSymbols":
  true, "requireNumbers": false, "requireUppercaseCharacters": false, "requireLowercaseCharacters":
  false, "allowUsersToChangePassword": false, "hardExpiry": false}, "responseElements":
  null, "requestID": "7685efa9-5c56-451a-bd25-3db520108589", "eventID": "ccc1d5c2-dd72-4798-8023-ed5a4205f2d5",
  "readOnly": false, "eventType": "AwsApiCall", "managementEvent": true, "recipientAccountId":
  "111111111111", "eventCategory": "Management", "sessionCredentialFromConsole": "true"}'
output_fields:
- dest
- user
- user_agent
- src
- vendor_account
- vendor_region
- vendor_product
