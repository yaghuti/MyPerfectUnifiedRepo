{
    "version": "4.3",
    "name": "Qakbot Detection Coverage",
    "description": "security_content detection coverage for Qakbot",
    "domain": "mitre-enterprise",
    "techniques": [
        {
            "techniqueID": "T1055",
            "score": 5,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_process_injection_remote_thread.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/create_remote_thread_in_shell_application.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_command_shell_fetch_env_variables.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_process_injection_wermgr_child_process.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_process_injection_of_wermgr_to_known_browser.yml"
        },
        {
            "techniqueID": "T1055.002",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_process_injection_remote_thread.yml"
        },
        {
            "techniqueID": "T1033",
            "score": 3,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/system_user_discovery_with_whoami.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_system_discovery_using_qwinsta.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_system_discovery_using_ldap_nslookup.yml"
        },
        {
            "techniqueID": "T1566.001",
            "score": 5,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_iso_lnk_file_creation.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/office_product_spawn_cmd_process.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/office_document_executing_macro_code.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/office_application_spawn_regsvr32_process.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_phishing_recent_iso_exec_registry.yml"
        },
        {
            "techniqueID": "T1566",
            "score": 6,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_iso_lnk_file_creation.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/office_product_spawn_cmd_process.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/office_document_executing_macro_code.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/process_creating_lnk_file_in_suspicious_location.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/office_application_spawn_regsvr32_process.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_phishing_recent_iso_exec_registry.yml"
        },
        {
            "techniqueID": "T1204.001",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_iso_lnk_file_creation.yml"
        },
        {
            "techniqueID": "T1204",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_iso_lnk_file_creation.yml"
        },
        {
            "techniqueID": "T1059",
            "score": 3,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/wermgr_process_spawned_cmd_or_powershell_process.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/cmdline_tool_not_executed_in_cmd_shell.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/cmd_carry_out_string_command_parameter.yml"
        },
        {
            "techniqueID": "T1049",
            "score": 2,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/network_connection_discovery_netstat.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/network_connection_discovery_arp.yml"
        },
        {
            "techniqueID": "T1059.007",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/cmdline_tool_not_executed_in_cmd_shell.yml"
        },
        {
            "techniqueID": "T1047",
            "score": 2,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_wmi_process_call_create.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_wmi_impersonate_token.yml"
        },
        {
            "techniqueID": "T1218",
            "score": 3,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/regsvr32_with_known_silent_switch_cmdline.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_regsvr32_register_suspicious_path.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_regsvr32_renamed_binary.yml"
        },
        {
            "techniqueID": "T1218.010",
            "score": 3,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/regsvr32_with_known_silent_switch_cmdline.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_regsvr32_register_suspicious_path.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_regsvr32_renamed_binary.yml"
        },
        {
            "techniqueID": "T1574.002",
            "score": 3,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_masquerading_explorer_as_child_process.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dll_side_loading_in_calc.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dll_side_loading_process_child_of_calc.yml"
        },
        {
            "techniqueID": "T1574",
            "score": 4,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_masquerading_explorer_as_child_process.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dll_side_loading_in_calc.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dll_search_order_hijacking_hunt_with_sysmon.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dll_side_loading_process_child_of_calc.yml"
        },
        {
            "techniqueID": "T1053",
            "score": 3,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/schtasks_run_task_on_demand.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/scheduled_task_deleted_or_created_via_cmd.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_schtasks_create_run_as_system.yml"
        },
        {
            "techniqueID": "T1016",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/network_discovery_using_route_windows_app.yml"
        },
        {
            "techniqueID": "T1016.001",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/network_discovery_using_route_windows_app.yml"
        },
        {
            "techniqueID": "T1027",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/malicious_powershell_process___encoded_command.yml"
        },
        {
            "techniqueID": "T1592",
            "score": 2,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/recon_avproduct_through_pwh_or_wmi.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/recon_using_wmi_class.yml"
        },
        {
            "techniqueID": "T1562.001",
            "score": 2,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_spynet_reporting.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_defender_exclusion_registry_entry.yml"
        },
        {
            "techniqueID": "T1562",
            "score": 2,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_spynet_reporting.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_defender_exclusion_registry_entry.yml"
        },
        {
            "techniqueID": "T1059.003",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/cmd_carry_out_string_command_parameter.yml"
        },
        {
            "techniqueID": "T1059.001",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/recon_using_wmi_class.yml"
        },
        {
            "techniqueID": "T1071",
            "score": 2,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_app_layer_protocol_qakbot_namedpipe.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_app_layer_protocol_wermgr_connect_to_namedpipe.yml"
        },
        {
            "techniqueID": "T1569",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_service_created_with_suspicious_service_path.yml"
        },
        {
            "techniqueID": "T1569.002",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_service_created_with_suspicious_service_path.yml"
        },
        {
            "techniqueID": "T1036",
            "score": 3,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/system_processes_run_from_unexpected_locations.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_copy_on_system32.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/executables_or_script_creation_in_suspicious_path.yml"
        },
        {
            "techniqueID": "T1036.003",
            "score": 2,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/system_processes_run_from_unexpected_locations.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_copy_on_system32.yml"
        },
        {
            "techniqueID": "T1543",
            "score": 2,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_process_file_path.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/services_exe_lolbas_execution_process_spawn.yml"
        },
        {
            "techniqueID": "T1543.003",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/services_exe_lolbas_execution_process_spawn.yml"
        },
        {
            "techniqueID": "T1053.005",
            "score": 3,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/scheduled_task_deleted_or_created_via_cmd.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/winevent_windows_task_scheduler_event_action_started.yml\n\nhttps://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_schtasks_create_run_as_system.yml"
        },
        {
            "techniqueID": "T1055.001",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_process_injection_of_wermgr_to_known_browser.yml"
        },
        {
            "techniqueID": "T1566.002",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/process_creating_lnk_file_in_suspicious_location.yml"
        },
        {
            "techniqueID": "T1482",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/nltest_domain_trust_discovery.yml"
        },
        {
            "techniqueID": "T1112",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_modify_registry_qakbot_binary_data_registry.yml"
        },
        {
            "techniqueID": "T1574.001",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dll_search_order_hijacking_hunt_with_sysmon.yml"
        },
        {
            "techniqueID": "T1547.001",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/registry_keys_used_for_persistence.yml"
        },
        {
            "techniqueID": "T1547",
            "score": 1,
            "comment": "https://github.com/splunk/security_content/blob/develop/detections/endpoint/registry_keys_used_for_persistence.yml"
        }
    ],
    "gradient": {
        "colors": [
            "#ffffff",
            "#66b1ff",
            "#096ed7"
        ],
        "minValue": 0,
        "maxValue": 5
    },
    "filters": {
        "platforms": [
            "Windows",
            "Linux",
            "macOS",
            "AWS",
            "GCP",
            "Azure",
            "Office 365",
            "SaaS"
        ]
    },
    "legendItems": [
        {
            "label": "NO available detections",
            "color": "#ffffff"
        },
        {
            "label": "Some detections available",
            "color": "#66b1ff"
        }
    ],
    "showTacticRowBackground": true,
    "tacticRowBackground": "#dddddd",
    "sorting": 3
}